<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>アカウント</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>👤 アカウント</h1>
    <nav class="navbar">
      <a href="index.html" class="btn">🏠 ホーム</a>
      <a href="procedure.html" class="btn">📄 手続きガイド</a>
      <a href="map.html" class="btn">🗺️ マップ</a>
      <a href="review.html" class="btn">⭐ レビュー</a>
      <a href="search.html" class="btn">🔎 検索</a>
      <a href="profile.html" class="btn">👤 プロフィール</a>
      <a href="login.html" class="btn">🔐 ログイン</a>
      <a href="admin.html" class="btn admin-only">🛠 管理</a>
    </nav>
  </header>

  <main>
    <section class="card">
      <h2>ログイン情報</h2>
      <p id="email">メール：</p>
      <p id="role">権限：</p>

      <button class="btn-submit" id="logoutBtn" style="background:#a30000;">
        ログアウト
      </button>
    </section>
  </main>

  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyB8dt1NgMhBtKlUeFzCAzImuKKjzKCrOTM",
      authDomain: "kobe-life-guide.firebaseapp.com",
      projectId: "kobe-life-guide"
    };

    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // 表示
    auth.onAuthStateChanged(user => {
      if (!user) return; // 未登录会被 guard 拦回 login
      document.getElementById("email").textContent = "メール：" + user.email;
      document.getElementById("role").textContent =
        "権限：" + (localStorage.getItem("auth_role") || "user");
    });

    // 退出
    document.getElementById("logoutBtn").onclick = async () => {
      await auth.signOut();
      localStorage.clear();
      location.replace("login.html");
    };
  </script>

  <script src="auth-guard.js"></script>
</body>
</html>
